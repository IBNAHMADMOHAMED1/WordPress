!function(t){formintorjs.define(["text!tpl/popups.html"],function(i){return Backbone.View.extend({className:"wpmudev-section--integrations",loaderTpl:Forminator.Utils.template(t(i).find("#popup-loader-tpl").html()),model:{},events:{"click .forminator-addon-connect":"connect_addon","click .forminator-addon-disconnect":"disconnect_addon","click .forminator-addon-form-disconnect":"form_disconnect_addon","click .forminator-addon-next":"submit_next_step","click .forminator-addon-back":"go_prev_step","click .forminator-addon-finish":"finish_steps"},initialize:function(t){this.slug=t.slug,this.nonce=t.nonce,this.action=t.action,this.form_id=t.form_id,this.multi_id=t.multi_id,this.global_id=t.global_id,this.step=0,this.next_step=!1,this.prev_step=!1,this.scrollbar_width=this.get_scrollbar_width();var i=this;return this.$el.find(".forminator-integration-close, .forminator-addon-close").on("click",function(){i.close(i)}),this.render()},render:function(){var t={};t.action=this.action,t._ajax_nonce=this.nonce,t.data={},t.data.slug=this.slug,t.data.step=this.step,t.data.current_step=this.step,t.data.global_id=this.global_id,this.form_id&&(t.data.form_id=this.form_id),this.multi_id&&(t.data.multi_id=this.multi_id),this.request(t,!1,!0)},request:function(i,o,e){var n=this,a={data:i,close:o,loader:e};e&&(this.$el.find(".forminator-integration-popup__header").html(""),this.$el.find(".forminator-integration-popup__body").html(this.loaderTpl()),this.$el.find(".forminator-integration-popup__footer").html("")),this.$el.find(".sui-button:not(.disable-loader)").addClass("sui-button-onload"),this.ajax=t.post({url:Forminator.Data.ajaxUrl,type:"post",data:i}).done(function(i){if(i&&i.success){n.render_reset(),n.render_body(i),n.render_footer(i),n.hide_elements();var e=i.data.data;n.on_render(e),n.$el.find(".sui-button").removeClass("sui-button-onload"),(o||!_.isUndefined(e.is_close)&&e.is_close)&&n.close(n),n.$el.find(".forminator-addon-close").on("click",function(){n.close(n)}),_.isUndefined(e.notification)||_.isUndefined(e.notification.type)||_.isUndefined(e.notification.text)||Forminator.Notification.open(e.notification.type,e.notification.text,4e3),_.isUndefined(e.has_back)?n.$el.find(".forminator-addon-back").hide():e.has_back?n.$el.find(".forminator-addon-back").show():n.$el.find(".forminator-addon-back").hide(),e.is_poll&&setTimeout(n.request(a.data,a.close,a.loader),5e3);t("#forminator-integration-popup .sui-box").height()>t(window).height()?t("#forminator-integration-popup .sui-dialog-overlay").css("right",n.scrollbar_width+"px"):t("#forminator-integration-popup .sui-dialog-overlay").css("right",0)}}),this.ajax.always(function(){n.$el.find(".fui-loading-dialog").remove()})},render_reset:function(){var i=t(".forminator-integration-popup__body"),o=t(".forminator-integration-popup__footer");i.is(":hidden")&&i.css("display",""),o.is(":hidden")&&o.css("display","")},render_body:function(t){this.$el.find(".forminator-integration-popup__body").html(t.data.data.html);var i=this.$el.find(".forminator-integration-popup__body .forminator-integration-popup__header").remove();i.length>0&&this.$el.find(".forminator-integration-popup__header").html(i.html())},render_footer:function(t){var i=this,o=t.data.data.buttons;i.$el.find(".sui-box-footer").html("");var e=this.$el.find(".forminator-integration-popup__body .forminator-integration-popup__footer-temp").remove();e.length>0&&this.$el.find(".forminator-integration-popup__footer").html(e.html()),_.each(o,function(t){i.$el.find(".sui-box-footer").append(t.markup)}),i.$el.find(".sui-box-footer").removeClass("sui-content-center").addClass("sui-content-separated"),i.$el.find(".sui-box-footer").children(".forminator-integration-popup__close").length>0&&i.$el.find(".sui-box-footer").removeClass("sui-content-separated").addClass("sui-content-center")},hide_elements:function(){var i=t(".forminator-integration-popup__body"),o=t(".forminator-integration-popup__footer"),e=i.html(),n=o.html();e.trim().length||i.hide(),n.trim().length||o.hide()},on_render:function(t){this.delegateEvents(),Forminator.Utils.sui_delegate_events(),Forminator.Utils.forminator_select2_tags(this.$el,{}),_.isUndefined(t.forminator_addon_current_step)||(this.step=+t.forminator_addon_current_step),_.isUndefined(t.forminator_addon_has_next_step)||(this.next_step=t.forminator_addon_has_next_step),_.isUndefined(t.forminator_addon_has_prev_step)||(this.prev_step=t.forminator_addon_has_prev_step)},get_step:function(){return this.next_step?this.step+1:this.step},get_prev_step:function(){return this.prev_step?this.step-1:this.step},connect_addon:function(i){var o={},e=this.$el.find("form"),n={slug:this.slug,step:this.get_step(),global_id:this.global_id,current_step:this.step},a=e.serialize();this.form_id&&(n.form_id=this.form_id),this.multi_id&&(n.multi_id=this.multi_id),a=a+"&"+t.param(n),o.action=this.action,o._ajax_nonce=this.nonce,o.data=a,this.request(o,!1,!1)},submit_next_step:function(i){var o={},e=this.$el.find("form"),n={slug:this.slug,step:this.get_step(),global_id:this.global_id,current_step:this.step},a=e.serialize();this.form_id&&(n.form_id=this.form_id),a=a+"&"+t.param(n),o.action=this.action,o._ajax_nonce=this.nonce,o.data=a,this.request(o,!1,!1)},go_prev_step:function(t){var i={},o={slug:this.slug,step:this.get_prev_step(),global_id:this.global_id,current_step:this.step};this.form_id&&(o.form_id=this.form_id),this.multi_id&&(o.multi_id=this.multi_id),i.action=this.action,i._ajax_nonce=this.nonce,i.data=o,this.request(i,!1,!1)},finish_steps:function(i){var o={},e=this.$el.find("form"),n={slug:this.slug,step:this.get_step(),global_id:this.global_id,current_step:this.step},a=e.serialize();this.form_id&&(n.form_id=this.form_id),this.multi_id&&(n.multi_id=this.multi_id),a=a+"&"+t.param(n),o.action=this.action,o._ajax_nonce=this.nonce,o.data=a,this.request(o,!1,!1)},disconnect_addon:function(t){var i={};i.action="forminator_addon_deactivate",i._ajax_nonce=this.nonce,i.data={},i.data.slug=this.slug,i.data.global_id=this.global_id,this.request(i,!0,!1)},form_disconnect_addon:function(t){var i={};i.action="forminator_addon_deactivate_for_module",i._ajax_nonce=this.nonce,i.data={},i.data.slug=this.slug,i.data.form_id=this.form_id,i.data.form_type="form",this.multi_id&&(i.data.multi_id=this.multi_id),this.request(i,!0,!1)},close:function(t){t.ajax.abort(),t.remove(),Forminator.Integrations_Popup.close(),Forminator.Events.trigger("forminator:addons:reload")},get_scrollbar_width:function(){var i=0;if(navigator.userAgent.match("MSIE")){var o=t('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body"),e=t('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:-1e3}).appendTo("body");i=o.width()-e.width(),o.add(e).remove()}else{var n=t("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:-1e3}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});i=100-n.width(),n.parent().remove()}return i}})})}(jQuery);